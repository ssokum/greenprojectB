<!DOCTYPE html>
<html lang="ko"
      xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layouts/exampleLayout}">


<div layout:fragment="content" class="container mt-5">
    <div class="d-flex justify-content-between align-items-center mb-3">
        <h2 class="text-start">ê³µì§€ì‚¬í•­<small>ìƒˆë¡œìš´ ì†Œë“¤ê³¼ ìœ ìš©í•œ ì •ë³´ë“¤ì„ í•œê³³ì—ì„œ í™•ì¸í•˜ì„¸ìš”.</small></h2>
    </div>

    <!-- ğŸ“‘ ê³µì§€ì‚¬í•­ í…Œì´ë¸” -->
    <table class="table table-hover text-center align-middle">
        <thead class="table-dark">
        <tr>
            <th>No.</th>
            <th>ì œëª©</th>
            <th>ì‘ì„±ì</th>
            <th>ì‘ì„±ì¼</th>
        </tr>
        </thead>
        <tbody>
        <tr th:each="notice : ${noticeList}">
            <td th:text="${notice.idx}">1</td>
            <td class="text-start">
                <a th:href="@{'/notice/detail/' + ${notice.idx}}" th:text="${notice.title}"></a>
            </td>
            <td th:text="${notice.writer}"></td>
            <td th:text="${#temporals.format(notice.createDate, 'yyyy-MM-dd')}"></td>
        </tr>
        <tr th:if="${#lists.isEmpty(noticeList.content)}">
            <td colspan="4">ê³µì§€ì‚¬í•­ì´ ì—†ìŠµë‹ˆë‹¤.</td>
        </tr>
        </tbody>
    </table>
    <!-- ê²€ìƒ‰ë°” + ê³µì§€ ì‘ì„±-->
    <div class="d-flex justify-content-between align-items-center mb-3">
        <!-- ê²€ìƒ‰ë°” -->
        <form id="searchForm" class="d-flex align-items-center" method="get" th:action="@{/notice/noticeMain}">
            <div class="input-group" style="min-width: 300px; max-width: 500px;">
                <input id="keywordInput" type="text" class="form-control" name="keyword"
                       placeholder="ì œëª© ë˜ëŠ” ë‚´ìš©ì„ ì…ë ¥í•˜ì„¸ìš”"
                       th:value="${keyword}">
                <button type="submit" class="btn btn-outline-primary">
                    <i class="fas fa-search"></i>
                </button>
            </div>
        </form>

        <!-- SweetAlert2 CDN -->
        <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

        <script>
            document.getElementById('searchForm').addEventListener('submit', function(e) {
                const keyword = document.getElementById('keywordInput').value.trim();
                if (!keyword) {
                    e.preventDefault();  // í¼ ì œì¶œ ë§‰ê¸°
                    Swal.fire({
                        text: 'ê²€ìƒ‰ì–´ë¥¼ ì…ë ¥í•´ ì£¼ì„¸ìš”.',
                        confirmButtonText: 'í™•ì¸',
                        customClass: {
                            popup: 'my-popup',
                            confirmButton: 'my-confirm-button',
                            actions: 'my-actions',
                            closeButton: 'my-close-button'
                        },
                        showCloseButton: true,
                        backdrop: true,
                        allowOutsideClick: true
                    });
                }
            });
        </script>

        <!-- ê³µì§€ ì‘ì„± ë²„íŠ¼ (ê´€ë¦¬ìë§Œ í‘œì‹œ) -->
        <a th:if="${#authorization.expression('hasRole(''ADMIN'')')}"
           th:href="@{/notice/noticeWrite}" class="btn btn-primary ms-3">
            ê³µì§€ ì‘ì„±
        </a>
    </div>

    <!-- í˜ì´ì§€ ë„¤ì´ì…˜ -->
    <div class="text-center">
        <ul class="pagination justify-content-center">
            <th:block th:if="${pag > 1}"><li class="page-item"><a class="page-link text-secondary" th:href="@{noticeMain(pageSize=${pageSize},pag=0)}">ì²«í˜ì´ì§€</a></li></th:block>
            <th:block th:if="${curBlock > 0}"><li class="page-item"><a class="page-link text-secondary" th:href="@{noticeMain(pageSize=${pageSize},pag=${(curBlock-1)*blockSize+1-1})}">ì´ì „ë¸”ë¡</a></li></th:block>
            <th:block th:each="i: ${#numbers.sequence((curBlock*blockSize)+1,(curBlock*blockSize)+blockSize)}">
                <th:block th:if="${i <= totPage && i == pag}"><li class="page-item active"><a class="page-link bg-secondary border-secondary" th:href="@{noticeMain(pageSize=${pageSize},pag=${i-1})}" th:text="${i}"></a></li></th:block>
                <th:block th:if="${i <= totPage && i != pag}"><li class="page-item"><a class="page-link text-secondary" th:href="@{noticeMain(pageSize=${pageSize},pag=${i-1})}" th:text="${i}"></a></li></th:block>
            </th:block>
            <th:block th:if="${curBlock < lastBlock}"><li class="page-item"><a class="page-link text-secondary" th:href="@{noticeMain(pageSize=${pageSize},pag=${(curBlock+1)*blockSize+1-1})}">ë‹¤ìŒë¸”ë¡</a></li></th:block>
            <th:block th:if="${pag < totPage}"><li class="page-item"><a class="page-link text-secondary" th:href="@{noticeMain(pageSize=${pageSize},pag=${totPage-1})}">ë§ˆì§€ë§‰í˜ì´ì§€</a></li></th:block>
        </ul>
    </div>
</div>
</html>